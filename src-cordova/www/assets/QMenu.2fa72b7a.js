var Le=Object.defineProperty,Be=Object.defineProperties;var Oe=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var Z=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))Re.call(t,n)&&Z(e,n,t[n]);if(J)for(var n of J(t))$e.call(t,n)&&Z(e,n,t[n]);return e},O=(e,t)=>Be(e,Oe(t));import{r as T,as as se,R as ee,a0 as ce,P as te,w as x,B as Fe,C as A,y as fe,U as Ae,E as R,aP as S,K as De,l as $,an as ze,aQ as _e,aR as Ie,e as g,N as D,I as Qe,q as Ke,T as Ne,A as Ve,x as je,aC as Ge,aL as Ue,V as Xe}from"./index.a68bc811.js";import{c as Ye,u as Je,a as Ze,b as et}from"./use-form.cb89fda3.js";import{u as tt,a as nt}from"./use-dark.4e3578ff.js";import{b as ne,c as ot,a as it}from"./focus-manager.387b0375.js";import{u as lt}from"./use-tick.65c3baf2.js";import{u as at}from"./use-timeout.ef68d622.js";const ut={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function rt({showing:e,avoidEmit:t,configureAnchorEl:n}){const{props:l,proxy:i,emit:s}=fe(),o=T(null);let d;function f(a){return o.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const r={};n===void 0&&(Object.assign(r,{hide(a){i.hide(a)},toggle(a){i.toggle(a),a.qAnchorHandled=!0},toggleKey(a){se(a,13)===!0&&r.toggle(a)},contextClick(a){i.hide(a),ee(a),ce(()=>{i.show(a),a.qAnchorHandled=!0})},prevent:ee,mobileTouch(a){if(r.mobileCleanup(a),f(a)!==!0)return;i.hide(a),o.value.classList.add("non-selectable");const v=a.target;te(r,"anchor",[[v,"touchmove","mobileCleanup","passive"],[v,"touchend","mobileCleanup","passive"],[v,"touchcancel","mobileCleanup","passive"],[o.value,"contextmenu","prevent","notPassive"]]),d=setTimeout(()=>{i.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){o.value.classList.remove("non-selectable"),clearTimeout(d),e.value===!0&&a!==void 0&&Ye()}}),n=function(a=l.contextMenu){if(l.noParentEvent===!0||o.value===null)return;let v;a===!0?i.$q.platform.is.mobile===!0?v=[[o.value,"touchstart","mobileTouch","passive"]]:v=[[o.value,"mousedown","hide","passive"],[o.value,"contextmenu","contextClick","notPassive"]]:v=[[o.value,"click","toggle","passive"],[o.value,"keyup","toggleKey","passive"]],te(r,"anchor",v)});function c(){Ae(r,"anchor")}function h(a){for(o.value=a;o.value.classList.contains("q-anchor--skip");)o.value=o.value.parentNode;n()}function m(){if(l.target===!1||l.target===""||i.$el.parentNode===null)o.value=null;else if(l.target===!0)h(i.$el.parentNode);else{let a=l.target;if(typeof l.target=="string")try{a=document.querySelector(l.target)}catch{a=void 0}a!=null?(o.value=a.$el||a,n()):(o.value=null,console.error(`Anchor: target "${l.target}" not found`))}}return x(()=>l.contextMenu,a=>{o.value!==null&&(c(),n(a))}),x(()=>l.target,()=>{o.value!==null&&c(),m()}),x(()=>l.noParentEvent,a=>{o.value!==null&&(a===!0?c():n())}),Fe(()=>{m(),t!==!0&&l.modelValue===!0&&o.value===null&&s("update:modelValue",!1)}),A(()=>{clearTimeout(d),c()}),{anchorEl:o,canShow:f,anchorEvents:r}}function st(e,t){const n=T(null);let l;function i(d,f){const r=`${f!==void 0?"add":"remove"}EventListener`,c=f!==void 0?f:l;d!==window&&d[r]("scroll",c,R.passive),window[r]("scroll",c,R.passive),l=f}function s(){n.value!==null&&(i(n.value),n.value=null)}const o=x(()=>e.noParentEvent,()=>{n.value!==null&&(s(),t())});return A(o),{localScrollTarget:n,unconfigureScrollTarget:s,changeScrollEvent:i}}const E=[];function Bt(e){return E.find(t=>t.__qPortalInnerRef.value!==null&&t.__qPortalInnerRef.value.contains(e))}function de(e,t){do{if(e.$options.name==="QMenu"){if(e.hide(t),e.$props.separateClosePopup===!0)return S(e)}else if(e.__qPortalInnerRef!==void 0){const n=S(e);return n!==void 0&&n.$options.name==="QPopupProxy"?(e.hide(t),n):e}e=S(e)}while(e!=null)}function Ot(e,t,n){for(;n!==0&&e!==void 0&&e!==null;){if(e.__qPortalInnerRef!==void 0){if(n--,e.$options.name==="QMenu"){e=de(e,t);continue}e.hide(t)}e=S(e)}}function ct(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function ft(e,t,n,l){const i=T(!1),s=T(!1);let o=null;const d={},f=l===!0&&ct(e);function r(h){if(h===!0){ne(d),s.value=!0;return}s.value=!1,i.value===!1&&(f===!1&&o===null&&(o=_e()),i.value=!0,E.push(e.proxy),ot(d))}function c(h){if(s.value=!1,h!==!0)return;ne(d),i.value=!1;const m=E.indexOf(e.proxy);m>-1&&E.splice(m,1),o!==null&&(Ie(o),o=null)}return De(()=>{c(!0)}),Object.assign(e.proxy,{__qPortalInnerRef:t}),{showPortal:r,hidePortal:c,portalIsActive:i,portalIsAccessible:s,renderPortal:()=>f===!0?n():i.value===!0?[$(ze,{to:o},n())]:void 0}}const dt={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function ht(e,t){const n=T(t.value);return x(t,l=>{ce(()=>{n.value=l})}),{transition:g(()=>"q-transition--"+(n.value===!0?e.transitionHide:e.transitionShow)),transitionStyle:g(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}const y=[];let P;function mt(e){P=e.keyCode===27}function vt(){P===!0&&(P=!1)}function gt(e){P===!0&&(P=!1,se(e,27)===!0&&y[y.length-1](e))}function he(e){window[e]("keydown",mt),window[e]("blur",vt),window[e]("keyup",gt),P=!1}function pt(e){D.is.desktop===!0&&(y.push(e),y.length===1&&he("addEventListener"))}function oe(e){const t=y.indexOf(e);t>-1&&(y.splice(t,1),y.length===0&&he("removeEventListener"))}const b=[];function me(e){b[b.length-1](e)}function xt(e){D.is.desktop===!0&&(b.push(e),b.length===1&&document.body.addEventListener("focusin",me))}function yt(e){const t=b.indexOf(e);t>-1&&(b.splice(t,1),b.length===0&&document.body.removeEventListener("focusin",me))}let ve;const{notPassiveCapture:q}=R,w=[];function H(e){clearTimeout(ve);const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let n=E.length-1;for(;n>=0;){const l=E[n].$;if(l.type.name!=="QDialog")break;if(l.props.seamless!==!0)return;n--}for(let l=w.length-1;l>=0;l--){const i=w[l];if((i.anchorEl.value===null||i.anchorEl.value.contains(t)===!1)&&(t===document.body||i.innerRef.value!==null&&i.innerRef.value.contains(t)===!1))e.qClickOutside=!0,i.onClickOutside(e);else return}}function bt(e){w.push(e),w.length===1&&(document.addEventListener("mousedown",H,q),document.addEventListener("touchstart",H,q))}function ie(e){const t=w.findIndex(n=>n===e);t>-1&&(w.splice(t,1),w.length===0&&(clearTimeout(ve),document.removeEventListener("mousedown",H,q),document.removeEventListener("touchstart",H,q)))}let le,ae;function ue(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function wt(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const F={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{F[`${e}#ltr`]=e,F[`${e}#rtl`]=e});function re(e,t){const n=e.split(" ");return{vertical:n[0],horizontal:F[`${n[1]}#${t===!0?"rtl":"ltr"}`]}}function Tt(e,t){let{top:n,left:l,right:i,bottom:s,width:o,height:d}=e.getBoundingClientRect();return t!==void 0&&(n-=t[1],l-=t[0],s+=t[1],i+=t[0],o+=t[0],d+=t[1]),{top:n,left:l,right:i,bottom:s,width:o,height:d,middle:l+(i-l)/2,center:n+(s-n)/2}}function kt(e){return{top:0,center:e.offsetHeight/2,bottom:e.offsetHeight,left:0,middle:e.offsetWidth/2,right:e.offsetWidth}}function Et(e){if(D.is.ios===!0&&window.visualViewport!==void 0){const d=document.body.style,{offsetLeft:f,offsetTop:r}=window.visualViewport;f!==le&&(d.setProperty("--q-pe-left",f+"px"),le=f),r!==ae&&(d.setProperty("--q-pe-top",r+"px"),ae=r)}let t;const{scrollLeft:n,scrollTop:l}=e.el;if(e.absoluteOffset===void 0)t=Tt(e.anchorEl,e.cover===!0?[0,0]:e.offset);else{const{top:d,left:f}=e.anchorEl.getBoundingClientRect(),r=d+e.absoluteOffset.top,c=f+e.absoluteOffset.left;t={top:r,left:c,width:1,height:1,right:c+1,center:r,middle:c,bottom:r+1}}let i={maxHeight:e.maxHeight,maxWidth:e.maxWidth,visibility:"visible"};(e.fit===!0||e.cover===!0)&&(i.minWidth=t.width+"px",e.cover===!0&&(i.minHeight=t.height+"px")),Object.assign(e.el.style,i);const s=kt(e.el),o={top:t[e.anchorOrigin.vertical]-s[e.selfOrigin.vertical],left:t[e.anchorOrigin.horizontal]-s[e.selfOrigin.horizontal]};Pt(o,t,s,e.anchorOrigin,e.selfOrigin),i={top:o.top+"px",left:o.left+"px"},o.maxHeight!==void 0&&(i.maxHeight=o.maxHeight+"px",t.height>o.maxHeight&&(i.minHeight=i.maxHeight)),o.maxWidth!==void 0&&(i.maxWidth=o.maxWidth+"px",t.width>o.maxWidth&&(i.minWidth=i.maxWidth)),Object.assign(e.el.style,i),e.el.scrollTop!==l&&(e.el.scrollTop=l),e.el.scrollLeft!==n&&(e.el.scrollLeft=n)}function Pt(e,t,n,l,i){const s=n.bottom,o=n.right,d=Qe(),f=window.innerHeight-d,r=document.body.clientWidth;if(e.top<0||e.top+s>f)if(i.vertical==="center")e.top=t[l.vertical]>f/2?Math.max(0,f-s):0,e.maxHeight=Math.min(s,f);else if(t[l.vertical]>f/2){const c=Math.min(f,l.vertical==="center"?t.center:l.vertical===i.vertical?t.bottom:t.top);e.maxHeight=Math.min(s,c),e.top=Math.max(0,c-s)}else e.top=Math.max(0,l.vertical==="center"?t.center:l.vertical===i.vertical?t.top:t.bottom),e.maxHeight=Math.min(s,f-e.top);if(e.left<0||e.left+o>r)if(e.maxWidth=Math.min(o,r),i.horizontal==="middle")e.left=t[l.horizontal]>r/2?Math.max(0,r-o):0;else if(t[l.horizontal]>r/2){const c=Math.min(r,l.horizontal==="middle"?t.middle:l.horizontal===i.horizontal?t.right:t.left);e.maxWidth=Math.min(o,c),e.left=Math.max(0,c-e.maxWidth)}else e.left=Math.max(0,l.horizontal==="middle"?t.middle:l.horizontal===i.horizontal?t.left:t.right),e.maxWidth=Math.min(o,r-e.left)}var Rt=Ke({name:"QMenu",inheritAttrs:!1,props:O(p(p(p(p({},ut),Je),tt),dt),{persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ue},self:{type:String,validator:ue},offset:{type:Array,validator:wt},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}}),emits:[...Ze,"click","escape-key"],setup(e,{slots:t,emit:n,attrs:l}){let i=null,s,o,d;const f=fe(),{proxy:r}=f,{$q:c}=r,h=T(null),m=T(!1),a=g(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),v=nt(e,c),{registerTick:ge,removeTick:z}=lt(),{registerTimeout:_,removeTimeout:I}=at(),{transition:pe,transitionStyle:xe}=ht(e,m),{localScrollTarget:Q,changeScrollEvent:ye,unconfigureScrollTarget:be}=st(e,X),{anchorEl:k,canShow:we}=rt({showing:m}),{hide:K}=et({showing:m,canShow:we,handleShow:Ce,handleHide:Se,hideOnRouteChange:a,processOnMount:!0}),{showPortal:N,hidePortal:V,renderPortal:Te}=ft(f,h,He),M={anchorEl:k,innerRef:h,onClickOutside(u){if(e.persistent!==!0&&m.value===!0)return K(u),(u.type==="touchstart"||u.target.classList.contains("q-dialog__backdrop"))&&Xe(u),!0}},j=g(()=>re(e.anchor||(e.cover===!0?"center middle":"bottom start"),c.lang.rtl)),ke=g(()=>e.cover===!0?j.value:re(e.self||"top start",c.lang.rtl)),Ee=g(()=>(e.square===!0?" q-menu--square":"")+(v.value===!0?" q-menu--dark q-dark":"")),Pe=g(()=>e.autoClose===!0?{onClick:qe}:{}),G=g(()=>m.value===!0&&e.persistent!==!0);x(G,u=>{u===!0?(pt(L),bt(M)):(oe(L),ie(M))});function W(){it(()=>{let u=h.value;u&&u.contains(document.activeElement)!==!0&&(u=u.querySelector("[autofocus], [data-autofocus]")||u,u.focus({preventScroll:!0}))})}function Ce(u){if(z(),I(),i=e.noRefocus===!1?document.activeElement:null,xt(Y),N(),X(),s=void 0,u!==void 0&&(e.touchPosition||e.contextMenu)){const B=Ne(u);if(B.left!==void 0){const{top:Me,left:We}=k.value.getBoundingClientRect();s={left:B.left-We,top:B.top-Me}}}o===void 0&&(o=x(()=>c.screen.width+"|"+c.screen.height+"|"+e.self+"|"+e.anchor+"|"+c.lang.rtl,C)),e.noFocus!==!0&&document.activeElement.blur(),ge(()=>{C(),e.noFocus!==!0&&W()}),_(()=>{c.platform.is.ios===!0&&(d=e.autoClose,h.value.click()),C(),N(!0),n("show",u)},e.transitionDuration)}function Se(u){z(),I(),V(),U(!0),i!==null&&(u===void 0||u.qClickOutside!==!0)&&(i.focus(),i=null),_(()=>{V(!0),n("hide",u)},e.transitionDuration)}function U(u){s=void 0,o!==void 0&&(o(),o=void 0),(u===!0||m.value===!0)&&(yt(Y),be(),ie(M),oe(L)),u!==!0&&(i=null)}function X(){(k.value!==null||e.scrollTarget!==void 0)&&(Q.value=Ve(k.value,e.scrollTarget),ye(Q.value,C))}function qe(u){d!==!0?(de(r,u),n("click",u)):d=!1}function Y(u){G.value===!0&&e.noFocus!==!0&&Ue(h.value,u.target)!==!0&&W()}function L(u){n("escape-key"),K(u)}function C(){const u=h.value;u===null||k.value===null||Et({el:u,offset:e.offset,anchorEl:k.value,anchorOrigin:j.value,selfOrigin:ke.value,absoluteOffset:s,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function He(){return $(Ge,{name:pe.value,appear:!0},()=>m.value===!0?$("div",p(O(p({},l),{ref:h,tabindex:-1,class:["q-menu q-position-engine scroll"+Ee.value,l.class],style:[l.style,xe.value]}),Pe.value),je(t.default)):null)}return A(U),Object.assign(r,{focus:W,updatePosition:C}),Te}});export{Rt as Q,ft as a,xt as b,pt as c,oe as d,Ot as e,Bt as g,yt as r,dt as u};
