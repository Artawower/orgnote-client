var re=Object.defineProperty,oe=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var D=(e,a,t)=>a in e?re(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,q=(e,a)=>{for(var t in a||(a={}))se.call(a,t)&&D(e,t,a[t]);if(M)for(var t of M(a))ne.call(a,t)&&D(e,t,a[t]);return e},w=(e,a)=>oe(e,le(a));import{Q as ie}from"./QList.165c5524.js";import{u as H,a as W}from"./use-dark.0793a78f.js";import{c as V,h as A,a as ce}from"./render.4975c230.js";import{c,h as b,g as X,r as P,w as $,af as ue,o as Y,P as de,O as fe,y as me,A as O,S as N,t as E,aP as I,Z,u as ve,m as h,n as z,W as g,p as r,V as T,f as d,a2 as G,X as B,a1 as Q,Y as F,a3 as _e,$ as J,at as pe,_ as he,ar as K}from"./index.e5e5ad80.js";import{u as ge,e as be,g as Se}from"./use-virtual-scroll.b23a5633.js";import{_ as qe,Q as ye,a as xe}from"./AuthorInfo.75ad53a6.js";import{u as ee,Q as we}from"./view.dbe46bfd.js";import{u as ke,a as Ne,Q as L}from"./QBtn.4b568f31.js";import{b as U}from"./QBadge.e5c632ba.js";import"./Ripple.d018c11c.js";import"./rtl.4b414a6d.js";import"./QSpinner.6600b362.js";import"./QIcon.b994d6a9.js";import"./QAvatar.da0a2ba4.js";import"./use-router-link.ae62ab1e.js";const Ve=["horizontal","vertical","cell","none"];var Ce=V({name:"QMarkupTable",props:w(q({},H),{dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>Ve.includes(e)}}),setup(e,{slots:a}){const t=X(),o=W(e,t.proxy.$q),l=c(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(o.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>b("div",{class:l.value},[b("table",{class:"q-table"},A(a.default))])}});function Qe(e,a){return b("div",e,[b("table",{class:"q-table"},a)])}const ze={list:ie,table:Ce},Te=["list","table","__qtable"];var Be=V({name:"QVirtualScroll",props:w(q({},ge),{type:{type:String,default:"list",validator:e=>Te.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}}),setup(e,{slots:a,attrs:t}){let o;const l=P(null),n=c(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:s,localResetVirtualScroll:f,padVirtualScroll:k,onVirtualScrollEvt:y}=be({virtualScrollLength:n,getVirtualScrollTarget:_,getVirtualScrollEl:u}),m=c(()=>{if(n.value===0)return[];const x=(te,ae)=>({index:s.value.from+ae,item:te});return e.itemsFn===void 0?e.items.slice(s.value.from,s.value.to).map(x):e.itemsFn(s.value.from,s.value.to-s.value.from).map(x)}),v=c(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),i=c(()=>e.scrollTarget!==void 0?{}:{tabindex:0});$(n,()=>{f()}),$(()=>e.scrollTarget,()=>{S(),p()});function u(){return l.value.$el||l.value}function _(){return o}function p(){o=Se(u(),e.scrollTarget),o.addEventListener("scroll",y,O.passive)}function S(){o!==void 0&&(o.removeEventListener("scroll",y,O.passive),o=void 0)}function C(){let x=k(e.type==="list"?"div":"tbody",m.value.map(a.default));return a.before!==void 0&&(x=a.before().concat(x)),ce(a.after,x)}return ue(()=>{f()}),Y(()=>{p()}),de(()=>{p()}),fe(()=>{S()}),me(()=>{S()}),()=>{if(a.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?Qe({ref:l,class:"q-table__middle "+v.value},C()):b(ze[e.type],q(w(q({},t),{ref:l,class:[t.class,v.value]}),i.value),C)}}}),R=V({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:a}){const t=c(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>b(e.tag,{class:t.value},A(a.default))}}),Pe=V({name:"QCardActions",props:w(q({},ke),{vertical:Boolean}),setup(e,{slots:a}){const t=Ne(e),o=c(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>b("div",{class:o.value},A(a.default))}}),$e=V({name:"QCard",props:w(q({},H),{tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean}),setup(e,{slots:a}){const t=X(),o=W(e,t.proxy.$q),l=c(()=>"q-card"+(o.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>b(e.tag,{class:l.value},A(a.default))}});const Ae={key:0,class:"q-px-md"},Ie=["src"],Re={key:1,class:"mock-picture pointer rounded-borders"},Fe={class:"text-overline"},Me={class:"text-caption text-grey rft"},j=N({__name:"PublicNoteView",props:{note:null,showAuthor:{type:Boolean}},setup(e){var v;const a=e,{note:t}=E(a),o=I(),l=Z(),n=i=>{o.selectNote(i),l.push({name:J.NoteDetail,params:{id:i.id}})},s=ee(),f=c(()=>s.tile),k=ve(),{showUserProfiles:y}=E(k),m=P((v=t.value.meta.images)==null?void 0:v[0]);return $(()=>t.value.meta.images,i=>{m.value=i==null?void 0:i[0]}),(i,u)=>(h(),z($e,{flat:""},{default:g(()=>[r(y)&&e.showAuthor?(h(),T("div",Ae,[d(qe,{author:r(t).author},null,8,["author"])])):G("",!0),d(R,{horizontal:"",class:F({"note-card-content":r(f),column:r(f)})},{default:g(()=>[r(f)&&m.value?(h(),T("img",{key:0,src:r(U)(m.value)},null,8,Ie)):(h(),z(R,{key:1,class:"flex col-3 flex-start"},{default:g(()=>[m.value?(h(),z(ye,{key:0,class:"pointer rounded-borders",src:r(U)(m.value)},null,8,["src"])):(h(),T("div",Re))]),_:1})),d(R,null,{default:g(()=>[B("div",Fe,Q(r(t).meta.category),1),B("div",{class:"text-h5 q-mt-sm q-mb-xs pointer",onClick:u[0]||(u[0]=_=>n(r(t)))},Q(r(t).meta.title),1),B("div",Me,Q(r(t).meta.description),1)]),_:1})]),_:1},8,["class"]),d(we),d(Pe,null,{default:g(()=>{var _,p;return[d(L,{flat:"",round:"",icon:"share"}),d(L,{onClick:u[1]||(u[1]=S=>n(r(t))),flat:"",color:"primary"},{default:g(()=>[_e(Q(i.$t("read")),1)]),_:1}),d(xe,{tags:(p=(_=r(t))==null?void 0:_.meta)==null?void 0:p.fileTags},null,8,["tags"])]}),_:1})]),_:1}))}});const De=N({__name:"AsyncPublicNoteContainer",props:{index:null,offset:null},setup(e){const a=e,t=I(),o=c(()=>{const{index:l}=a;return t.notes[l]});return(l,n)=>r(o)?pe(l.$slots,"default",{key:0,note:r(o)}):G("",!0)}});const Oe=N({__name:"PublicNotes",setup(e){N({PublicNoteView:j});const a=ee(),t=c(()=>a.tile),o=Z(),l=c(()=>o.currentRoute.value.name===J.UserNotes),n=P(null),s=I(),f=i=>Math.ceil(i/s.filters.limit)*s.filters.limit,k=P(!1),y=i=>{k.value=!0;const u=f(i);return s.fetchNotes(u),o.push({query:{limit:s.filters.limit,offset:u}}),Object.freeze(new Array(s.filters.limit).fill(null))},v=K().query.offset;return Y(()=>{!v||n.value.scrollTo(v)}),(i,u)=>{var _;return h(),T("div",{class:F(["q-pa-md items-start q-col-gutter-md",{row:r(t),column:!r(t)}])},[d(Be,{ref_key:"virtualScrollRef",ref:n,"items-size":r(s).notesCount,"virtual-scroll-slice-size":((_=r(s).filters)==null?void 0:_.limit)||10,"virtual-scroll-item-size":205,"virtual-scroll-slice-ratio-before":1,"virtual-scroll-slice-ratio-after":1,"items-fn":y,"scroll-target":"body",class:"full-width",style:{"max-height":"cacl(100vh - 66px)"}},{default:g(({index:p})=>{var S;return[d(De,{index:p,offset:(S=r(s).filters)==null?void 0:S.offset},{default:g(({note:C})=>[B("div",{class:F({fit:!r(t),"col-4":r(t)})},[d(j,{note:C,"show-author":!r(l)},null,8,["note","show-author"])],2)]),_:2},1032,["index","offset"])]}),_:1},8,["items-size","virtual-scroll-slice-size"])],2)}}});var Ee=he(Oe,[["__scopeId","data-v-55b91c04"]]);const lt=N({__name:"IndexPage",setup(e){const a=I(),t=K(),o=()=>{a.setFilters({searchText:t.query.search,userId:t.params.userId,limit:+t.query.limit,offset:+t.query.offset})},l=()=>{o(),a.loadNotes()};return l(),$(()=>t.params.userId,()=>{var n;((n=a.filters)==null?void 0:n.userId)!=t.params.userId&&l()}),(n,s)=>(h(),z(Ee,{notes:r(a).notes},null,8,["notes"]))}});export{lt as default};
