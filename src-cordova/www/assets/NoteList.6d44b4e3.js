import{P as h}from"./PublicNotePreview.3f55e05d.js";import{y as q}from"./ClosePopup.6775e2be.js";import{Q as A,_ as E}from"./AsyncItemContainer.c33b9601.js";import{g as p,aE as i,a as F,a9 as I,r as n,b5 as Q,aL as $,w as _,v as j,o as g,X as D,d as M,Z as w,e as O,ac as W,$ as N,Y as b,a0 as X}from"./index.446b2176.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";const Z=p({__name:"NoteList",props:{selectable:{type:Boolean},limit:{},offset:{},total:{},notes:{},fetchNotes:{},scrollTarget:{},height:{default:230}},setup(y){const l=y;p({PublicNotePreview:h});const c=i(l,"selectable"),S=i(l,"limit"),u=i(l,"total"),V=i(l,"notes"),k=q(),o=F(()=>k.tile),z=I(),a=n(null),R=Q(),B=$(l.fetchNotes,300),f=n(0);_(()=>f.value,e=>z.replace({query:{from:e}}));const v=+R.query.from||0,T=(e,t)=>{const s=Object.freeze(new Array(t).fill(null));return B(e,t),s};let m=!1;const d=()=>{m||!v||!u.value||!a.value||(setTimeout(()=>{a.value.scrollTo(v,"start")}),m=!0)},x=e=>{f.value=e.index};_([u,a],()=>d()),j(()=>{d()});const r=n([]),C=(e,t)=>{if(!!c.value){if(t){r.value=[...r.value,e];return}r.value=r.value.filter(s=>s.id!==e.id)}};return(e,t)=>(g(),D("div",{class:N(["q-pa-lg items-start public-notes",{row:o.value,column:!o.value}])},[e.scrollTarget?(g(),M(O(A),{key:0,ref_key:"virtualScrollRef",ref:a,onVirtualScroll:x,"items-size":u.value,"virtual-scroll-slice-size":(S.value||10)*3,"virtual-scroll-item-size":230,"items-fn":T,"scroll-target":e.scrollTarget,class:"full-width",style:{"max-height":"cacl(100vh - 66px)"}},{default:w(({index:s})=>[b(E,{"items-list":V.value,index:s,height:e.height},{default:w(({item:L})=>[X("div",{class:N({fit:!o.value,"col-4":o.value})},[b(h,{"note-preview":L,"show-author":!c.value,selectable:c.value,height:e.height,onSelected:t[0]||(t[0]=P=>C(e.note,P))},null,8,["note-preview","show-author","selectable","height"])],2)]),_:2},1032,["items-list","index","height"])]),_:1},8,["items-size","virtual-scroll-slice-size","scroll-target"])):W("",!0)],2))}});var ee=Y(Z,[["__scopeId","data-v-189b38f2"]]);export{ee as N};
