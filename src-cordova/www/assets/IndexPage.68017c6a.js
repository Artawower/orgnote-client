var D=Object.defineProperty,E=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var B=(e,t,a)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,_=(e,t)=>{for(var a in t||(t={}))j.call(t,a)&&B(e,a,t[a]);if(z)for(var a of z(t))U.call(t,a)&&B(e,a,t[a]);return e},h=(e,t)=>E(e,L(t));import{u as H,e as J,Q as G,g as K}from"./use-virtual-scroll.46b457b7.js";import{u as W,b as X}from"./QBtn.fd72d8fa.js";import{c as I,a as Y,d as Z}from"./QSpinner.34ccac42.js";import{c as u,h as b,g as ee,r as N,w as V,aj as te,o as M,J as ae,I as le,q as re,x as C,_ as S,a7 as T,u as s,av as oe,aa as se,aD as ie,a4 as ne,a5 as ce,a6 as Q,j as A,a0 as ue,f as w,a1 as P,a2 as fe,a3 as R,k as de}from"./index.1402a66b.js";import{_ as F}from"./PublicNoteView.46f69ca4.js";import{u as me}from"./view.b4a7f32b.js";import"./AuthorInfo.9b609284.js";import"./QSeparator.29018688.js";const ve=["horizontal","vertical","cell","none"];var _e=I({name:"QMarkupTable",props:h(_({},W),{dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>ve.includes(e)}}),setup(e,{slots:t}){const a=ee(),l=X(e,a.proxy.$q),o=u(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(l.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>b("div",{class:o.value},[b("table",{class:"q-table"},Y(t.default))])}});function be(e,t){return b("div",e,[b("table",{class:"q-table"},t)])}const ge={list:G,table:_e},pe=["list","table","__qtable"];var he=I({name:"QVirtualScroll",props:h(_({},H),{type:{type:String,default:"list",validator:e=>pe.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}}),setup(e,{slots:t,attrs:a}){let l;const o=N(null),i=u(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:r,localResetVirtualScroll:g,padVirtualScroll:y,onVirtualScrollEvt:p}=J({virtualScrollLength:i,getVirtualScrollTarget:x,getVirtualScrollEl:f}),k=u(()=>{if(i.value===0)return[];const c=($,O)=>({index:r.value.from+O,item:$});return e.itemsFn===void 0?e.items.slice(r.value.from,r.value.to).map(c):e.itemsFn(r.value.from,r.value.to-r.value.from).map(c)}),d=u(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),q=u(()=>e.scrollTarget!==void 0?{}:{tabindex:0});V(i,()=>{g()}),V(()=>e.scrollTarget,()=>{m(),n()});function f(){return o.value.$el||o.value}function x(){return l}function n(){l=K(f(),e.scrollTarget),l.addEventListener("scroll",p,C.passive)}function m(){l!==void 0&&(l.removeEventListener("scroll",p,C.passive),l=void 0)}function v(){let c=y(e.type==="list"?"div":"tbody",k.value.map(t.default));return t.before!==void 0&&(c=t.before().concat(c)),Z(t.after,c)}return te(()=>{g()}),M(()=>{n()}),ae(()=>{n()}),le(()=>{m()}),re(()=>{m()}),()=>{if(t.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?be({ref:o,class:"q-table__middle "+d.value},v()):b(ge[e.type],_(h(_({},a),{ref:o,class:[a.class,d.value]}),q.value),v)}}});const Se=S({__name:"AsyncPublicNoteContainer",props:{index:null,offset:null},setup(e){const t=e,a=T(),l=u(()=>{const{index:o,offset:i}=t;return a.notes[o]});return(o,i)=>s(l)?oe(o.$slots,"default",{key:0,note:s(l)}):se("",!0)}});const ye=S({__name:"PublicNotes",setup(e){S({PublicNoteView:F});const t=me(),a=u(()=>t.tile),l=ne(),o=u(()=>l.currentRoute.value.name===ce.UserNotes),i=N(null),r=T(),g=f=>Math.ceil(f/r.filters.limit)*r.filters.limit,y=N(!1),p=(f,x)=>{y.value=!0;const n=g(f);return r.fetchNotes(n),l.push({query:{limit:r.filters.limit,offset:n}}),Object.freeze(new Array(r.filters.limit).fill(null))},d=Q().query.offset,q=()=>{i.value.scrollTo(d)};return M(()=>{!d||setTimeout(()=>{q()},200)}),(f,x)=>{var n;return A(),ue("div",{class:R(["q-pa-md items-start q-col-gutter-md",{row:s(a),column:!s(a)}])},[w(he,{ref_key:"virtualScrollRef",ref:i,"items-size":s(r).notesCount,"virtual-scroll-slice-size":((n=s(r).filters)==null?void 0:n.limit)||10,"virtual-scroll-item-size":205,"virtual-scroll-slice-ratio-before":1,"virtual-scroll-slice-ratio-after":1,"items-fn":p,"scroll-target":"body",class:"full-width",style:{"max-height":"cacl(100vh - 66px)"}},{default:P(({index:m})=>{var v;return[w(Se,{index:m,offset:(v=s(r).filters)==null?void 0:v.offset},{default:P(({note:c})=>[fe("div",{class:R({fit:!s(a),"col-4":s(a)})},[w(F,{note:c,"show-author":!s(o)},null,8,["note","show-author"])],2)]),_:2},1032,["index","offset"])]}),_:1},8,["items-size","virtual-scroll-slice-size"])],2)}}});var qe=ie(ye,[["__scopeId","data-v-c9b0c2b8"]]);const Pe=S({__name:"IndexPage",setup(e){const t=T(),a=Q(),l=()=>{t.setFilters({searchText:a.query.search,userId:a.params.userId,limit:+a.query.limit,offset:+a.query.offset})};return l(),V(()=>a.params.userId,()=>{l(),t.loadNotes()}),t.loadNotes(),(o,i)=>(A(),de(qe,{notes:s(t).notes},null,8,["notes"]))}});export{Pe as default};
