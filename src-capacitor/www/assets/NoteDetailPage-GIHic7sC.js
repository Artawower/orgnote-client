import{Q as _}from"./QPage-BxJcDsX-.js";import{bG as h,I as d,d as y,w as g,aj as N,bH as M,h as b,k as P,a0 as w,bI as C,z as D,o as l,e as p,a2 as c,F as m,C as k,E as x}from"./index-DftpuOf4.js";import{u as I}from"./note-detail-commands-BF8_WzK9.js";import{r as A}from"./min-page-height-C83o81gH.js";import{A as B}from"./AuthorInfo-BOr5vdDr.js";import{N as S}from"./NoteDetail-Dxk1m6un.js";import{E as U}from"./EncryptionRequred-D1XWTbt4.js";import{u as v}from"./app-meta-0t4K0Twh.js";import"./mobile-viewport-changed-Bh9MDrxt.js";function E(e){var t;if((t=e==null?void 0:e.meta)!=null&&t.published)return h(`/detail/${e.id}`)}function f(e){const{title:t,description:o}=e.meta;return{title:t,meta:{"og:title":{property:"og:title",content:t},"og:type":{property:"og:type",content:"article"},...o&&{description:{name:"description",content:o}}}}}function H(e){const{fileTags:t}=e.meta;if(!t)return{};const o=t.reduce((r,a)=>({...r,[a]:{property:"article:tag",content:a}}),{});return{keywords:{name:"keywords",content:t.join(", ")},...o}}function R(e){const{images:t}=e.meta;return t!=null&&t.length?{"og:image":{property:"og:image",content:M(t[0],e.author.id)}}:{}}function j(e){const{nickName:t}=e.author||{};return t?{"profile:username":{property:"profile:username",content:t},"article:author":{property:"article:author",content:t}}:{}}function q(e){const t=E(e);return t?{"og:url":{property:"og:url",content:t}}:{}}function T(e){return{...f(e),meta:{...f(e).meta,...H(e),...R(e),...j(e),...q(e)}}}function V(e,t){const{setMeta:o,useDefaultMeta:r}=v(t.value);g(()=>e.currentNote,a=>{a&&o(t.value)}),N(()=>{r()})}function F(){const e=d(),t=y(()=>{const o=e.currentNote;return o?T(o):{}});V(e,t)}const O=b({__name:"NoteDetailPage",async setup(e,{expose:t}){t();let o,r;const a=P(),n=d(),{currentNote:s}=w(n);a.params.id&&([o,r]=C(()=>n.selectNoteById(a.params.id)),await o,r()),g(()=>a.params.id,u=>u&&n.selectNoteById(a.params.id)),I(),F();const i={route:a,currentNoteStore:n,currentNote:s,get resetPageMinHeight(){return A},AuthorInfo:B,NoteDetail:S,EncryptionRequired:U};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}});function Q(e,t,o,r,a,n){return l(),p(_,{class:"height-auto","style-fn":r.resetPageMinHeight},{default:c(()=>[m(r.EncryptionRequired,{note:r.currentNote},{default:c(()=>{var s,i,u;return[(s=r.currentNote)!=null&&s.author&&r.currentNote&&!((i=r.currentNote)!=null&&i.isMy)?(l(),p(r.AuthorInfo,{key:0,author:(u=r.currentNote)==null?void 0:u.author,class:"q-pb-lg"},{default:c(()=>[k(" >")]),_:1},8,["author"])):x("",!0),m(r.NoteDetail,{note:r.currentNote},null,8,["note"])]}),_:1},8,["note"])]),_:1},8,["style-fn"])}const $=D(O,[["render",Q],["__file","NoteDetailPage.vue"]]);export{$ as default};
