import{a as F,Q as O,u as K}from"./view-bF3BCiVJ.js";import{m as W,r as D,w as U,cx as $,bx as Y,d as _,h as E,b6 as T,bz as G,q as X,R as Q,z as A,o as r,A as P,b1 as ee,B as b,e as m,cv as te,E as h,F as c,H as N,a2 as l,cX as j,b2 as oe,aT as z,a9 as q,aa as I,C,D as p,bi as B,ak as Z,cY as ae,cZ as se,j as x,ab as R,aB as ne,c_ as le,c$ as re,d0 as ie,ap as ce,G as de,a3 as ue,bc as me,t as L,s as fe,l as ve,cz as he,d1 as _e,b5 as pe,a7 as H,bh as be,d2 as ge,br as ye}from"./index-DftpuOf4.js";import{A as we}from"./AuthorInfo-BOr5vdDr.js";function Se(t){return t.replace(/\.[^/.]+$/,"")}const ke=()=>{const t=W(),o=D("sm"),a=()=>o.value=t.screen.gt.sm?"xs":"sm";return U(()=>t.screen.gt.sm,a),a(),{iconSize:o}},Ne=$("selected-notes",()=>{const t=D(new Set),o=Y(),a=_(()=>t.value.size===o.notes.length),e=()=>{if(a.value){t.value.clear();return}t.value=new Set(o.notes.map(u=>u.id))},d=u=>{if(t.value.has(u)){t.value.delete(u);return}t.value.add(u)},f=u=>t.value.has(u),s=_(()=>o.notes.length===t.value.size),i=_(()=>t.value.size>0),n=()=>t.value.clear();return{toggleBulkNotesSelection:e,allNotesSelected:a,toggleNoteSelection:d,isNoteSelected:f,isAllNotesSelected:s,isSomeNotesSelected:i,selectedNotesIds:_(()=>[...t.value]),clearSelectedNotes:n}}),Pe=E({__name:"NoteFooter",props:{selectable:{type:Boolean},note:{}},setup(t,{expose:o}){o();const a=t,e=T(a,"selectable"),d=T(a,"note"),f=Ne(),s=G(),i=k=>{s.notify(`Feature ${k} is not implemented yet!`)},n=Y(),u=X(),w=async()=>{await n.markAsDeleted([d.value.id]),u.push({name:Q.Home})},v=()=>{u.push({name:Q.EditNote,params:{id:d.value.id}})},{iconSize:y}=ke(),S={props:a,selectable:e,note:d,selectedNotesStore:f,notifications:s,showNotImplemented:i,notesStore:n,router:u,deleteNote:w,editNote:v,iconSize:y};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}}),xe={class:"footer column q-py-bp-lg full-width"},Ce={class:"note-actions full-width row justify-between"},ze={class:"left"},qe={class:"right row gap-sm action-btns"};function Ie(t,o,a,e,d,f){return r(),P("div",xe,[ee(t.$slots,"default",{},void 0,!0),b("div",Ce,[b("div",ze,[e.selectable?(r(),m(te,{key:0,size:e.iconSize,"model-value":e.selectedNotesStore.isNoteSelected(e.note.id),"onUpdate:modelValue":o[0]||(o[0]=s=>e.selectedNotesStore.toggleNoteSelection(e.note.id))},null,8,["size","model-value"])):h("",!0)]),b("div",qe,[c(N,{onClick:o[1]||(o[1]=s=>e.notesStore.toggleBookmark(e.note)),size:e.iconSize,flat:"",round:"",icon:e.note.bookmarked?"o_bookmark":"o_bookmark_added",class:"q-pa-none"},null,8,["size","icon"]),c(N,{size:e.iconSize,flat:"",round:"",icon:"far fa-paper-plane",class:"q-pa-none"},{default:l(()=>[c(j,{class:"flex row no-wrap"},{default:l(()=>[c(N,{flat:"",rounded:"",size:"md",icon:"fa-brands fa-square-twitter",class:"q-pa-sm",onClick:o[2]||(o[2]=s=>e.showNotImplemented("Twitter share"))}),c(N,{flat:"",rounded:"",size:"md",icon:"fa-brands fa-telegram",class:"q-pa-sm",onClick:o[3]||(o[3]=s=>e.showNotImplemented("Telegram share"))}),c(N,{flat:"",rounded:"",size:"md",icon:"far fa-copy",class:"q-pa-sm",onClick:o[4]||(o[4]=s=>e.showNotImplemented("Copy link"))})]),_:1})]),_:1},8,["size"]),c(N,{size:e.iconSize,flat:"",round:"",icon:"fas fa-ellipsis",class:"q-pa-none"},{default:l(()=>[c(j,null,{default:l(()=>[c(oe,{style:{"min-width":"100px"}},{default:l(()=>[e.note.isMy?z((r(),m(q,{key:0,clickable:"",onClick:e.deleteNote},{default:l(()=>[c(I,{class:"text-capitalize"},{default:l(()=>[C(p(t.$t("delete")),1)]),_:1})]),_:1})),[[B]]):h("",!0),e.note.isMy?z((r(),m(q,{key:1,clickable:"",onClick:e.editNote},{default:l(()=>[c(I,{class:"text-capitalize"},{default:l(()=>[C(p(t.$t("edit")),1)]),_:1})]),_:1})),[[B]]):h("",!0),e.note.isMy?h("",!0):z((r(),m(q,{key:2,clickable:"",onClick:o[5]||(o[5]=s=>e.showNotImplemented(t.$t("report")))},{default:l(()=>[c(I,{class:"text-capitalize"},{default:l(()=>[C(p(t.$t("report")),1)]),_:1})]),_:1})),[[B]]),e.note.isMy?h("",!0):z((r(),m(q,{key:3,clickable:"",onClick:o[6]||(o[6]=s=>e.showNotImplemented(t.$t("save")))},{default:l(()=>[c(I,{class:"text-capitalize"},{default:l(()=>[C(p(t.$t("save")),1)]),_:1})]),_:1})),[[B]])]),_:1})]),_:1})]),_:1},8,["size"])])])])}const Be=A(Pe,[["render",Ie],["__scopeId","data-v-c2f65daa"],["__file","NoteFooter.vue"]]),Fe=Z({name:"QBreadcrumbsEl",props:{...ae,label:String,icon:String,tag:{type:String,default:"span"}},emits:["click"],setup(t,{slots:o}){const{linkTag:a,linkAttrs:e,linkClass:d,navigateOnClick:f}=se(),s=_(()=>({class:"q-breadcrumbs__el q-link flex inline items-center relative-position "+(t.disable!==!0?"q-link--focusable"+d.value:"q-breadcrumbs__el--disable"),...e.value,onClick:f})),i=_(()=>"q-breadcrumbs__el-icon"+(t.label!==void 0?" q-breadcrumbs__el-icon--with-label":""));return()=>{const n=[];return t.icon!==void 0&&n.push(x(R,{class:i.value,name:t.icon})),t.label!==void 0&&n.push(t.label),x(a.value,{...s.value},ne(o.default,n))}}}),Qe=["",!0],Ee=Z({name:"QBreadcrumbs",props:{...le,separator:{type:String,default:"/"},separatorColor:String,activeColor:{type:String,default:"primary"},gutter:{type:String,validator:t=>["none","xs","sm","md","lg","xl"].includes(t),default:"sm"}},setup(t,{slots:o}){const a=re(t),e=_(()=>`flex items-center ${a.value}${t.gutter==="none"?"":` q-gutter-${t.gutter}`}`),d=_(()=>t.separatorColor?` text-${t.separatorColor}`:""),f=_(()=>` text-${t.activeColor}`);return()=>{if(o.default===void 0)return;const s=ie(ce(o.default));if(s.length===0)return;let i=1;const n=[],u=s.filter(v=>v.type!==void 0&&v.type.name==="QBreadcrumbsEl").length,w=o.separator!==void 0?o.separator:()=>t.separator;return s.forEach(v=>{if(v.type!==void 0&&v.type.name==="QBreadcrumbsEl"){const y=i<u,S=v.props!==null&&Qe.includes(v.props.disable),k=(y===!0?"":" q-breadcrumbs--last")+(S!==!0&&y===!0?f.value:"");i++,n.push(x("div",{class:`flex items-center${k}`},[v])),y===!0&&n.push(x("div",{class:"q-breadcrumbs__separator"+d.value},w()))}else n.push(v)}),x("div",{class:"q-breadcrumbs"},[x("div",{class:e.value},n)])}}}),Ae=E({__name:"FilePath",props:{filePath:{}},setup(t,{expose:o}){o();const a=t,e=T(a,"filePath"),d=G(),s={props:a,filePath:e,notifications:d,searchInFolder:i=>d.notify(`This functionality is not implemented yet. You clicked on ${i}`),get removeFileExtension(){return Se}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}});function Te(t,o,a,e,d,f){return r(),m(Ee,{class:"text-italic color-secondary pointer flex breadcrumbs"},{separator:l(()=>[c(R,{size:"1.5em",name:"chevron_right",class:"color-secondary"})]),default:l(()=>[(r(!0),P(de,null,ue(e.filePath,(s,i)=>(r(),m(Fe,{class:"color-secondary text-no-wrap",label:i===e.filePath.length-1?e.removeFileExtension(s):s,key:s,onClick:me(n=>e.searchInFolder(s),["stop","prevent"])},null,8,["label","onClick"]))),128))]),_:1})}const De=A(Ae,[["render",Te],["__file","FilePath.vue"]]),Re=E({__name:"EncryptedNoteCard",props:{noteName:{}},setup(t,{expose:o}){o();const a={};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),Ve={class:"full-width lock-description"},Me={class:"text-center"},je={class:"text-center q-mt-md"};function Le(t,o,a,e,d,f){return r(),m(O,{class:"full-height color-main cursor-pointer"},{default:l(()=>[c(F,{class:"full-height flex center items-center"},{default:l(()=>[b("div",Ve,[c(R,{class:"shield-icon color-main",name:"sym_o_encrypted",size:"12rem"}),b("h4",Me,p(a.noteName)+" "+p(t.$t("is encrypted")),1),b("h5",je,p(t.$t("please, configure encryption settings for decrypt note")),1)])]),_:1})]),_:1})}const He=A(Re,[["render",Le],["__file","EncryptedNoteCard.vue"]]),Oe=E({__name:"PublicNotePreview",props:{notePreview:{},showAuthor:{type:Boolean},selectable:{type:Boolean},height:{},hideFooter:{type:Boolean},fullHeight:{type:Boolean}},setup(t,{expose:o}){var V,M;o();const a=t,{notePreview:e,selectable:d}=L(a),f=_(()=>`${a.height}px`),s=X(),i=g=>{const J=g.isMy?Q.RawEditor:Q.NoteDetail;s.push({name:J,params:{id:g.id}})},n=K(),u=_(()=>n.tile),w=fe(),{showUserProfiles:v}=L(w),y=D((M=(V=e.value)==null?void 0:V.meta.images)==null?void 0:M[0]);U(()=>{var g;return(g=e.value)==null?void 0:g.meta.images},g=>{y.value=g==null?void 0:g[0]});const S=ve(),k={props:a,notePreview:e,selectable:d,height:f,router:s,openNoteDetail:i,viewStore:n,isTile:u,settingsStore:w,showUserProfiles:v,previewImage:y,authStore:S,NoteFooter:Be,TagList:he,AuthorInfo:we,FilePath:De,ImageResolver:_e,EncryptedNoteCard:He,get extractDynamicValue(){return pe}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),Ue={key:0,class:"q-px-sm"},Ye={class:"full-width"},Ge={class:"text-overline"},Xe={class:"text-h4 text-weight-bold pointer"},Ze={class:"text-caption rft description"},Je={key:0,class:"italic color-secondary"},Ke={key:1,class:"mock-picture pointer rounded-borders"};function We(t,o,a,e,d,f){return r(),P("article",{style:ye({height:e.height})},[e.notePreview.encrypted?(r(),m(e.EncryptedNoteCard,{key:0,noteName:e.notePreview.filePath.slice(-1)[0],onClick:o[0]||(o[0]=s=>e.openNoteDetail(e.notePreview))},null,8,["noteName"])):e.notePreview?(r(),m(O,{key:1,class:"full-height color-main",flat:""},{default:l(()=>{var s;return[(s=e.notePreview)!=null&&s.author&&e.showUserProfiles&&a.showAuthor?(r(),P("div",Ue,[c(e.AuthorInfo,{author:e.notePreview.author},null,8,["author"])])):h("",!0),c(F,{horizontal:"",class:H([{"note-card-content":e.isTile||!a.fullHeight,column:e.isTile,"full-height":a.fullHeight},"pointer q-px-sm"]),onClick:o[1]||(o[1]=i=>e.openNoteDetail(e.notePreview))},{default:l(()=>[e.isTile&&e.previewImage?(r(),m(e.ImageResolver,{key:0,src:e.previewImage},null,8,["src"])):h("",!0),c(F,{class:H(["fit q-pa-none q-pt-sm note-text-content",{"content-with-img":!!e.previewImage}])},{default:l(()=>{var i,n;return[b("div",Ye,[b("div",Ge,p(e.notePreview.meta.category),1),b("div",Xe,p(e.extractDynamicValue(e.notePreview.meta.title)||e.notePreview.filePath.slice(-1)[0]),1),e.notePreview.filePath?(r(),m(e.FilePath,{key:0,"file-path":e.notePreview.filePath,class:"q-py-xs"},null,8,["file-path"])):h("",!0),b("div",Ze,[e.settingsStore.config.common.developerMode?(r(),P("span",Je," ["+p(new Date(e.notePreview.updatedAt).toLocaleString())+"] ",1)):h("",!0),C(" "+p(e.notePreview.meta.description),1)])]),c(e.TagList,{tags:(n=(i=e.notePreview)==null?void 0:i.meta)==null?void 0:n.fileTags,inline:!0},null,8,["tags"])]}),_:1},8,["class"]),!e.isTile&&e.previewImage?(r(),m(F,{key:1,class:"flex col-3 flex-start q-pa-none q-pt-sm justify-end img-preview-section"},{default:l(()=>{var i,n,u;return[e.previewImage?(r(),m(e.ImageResolver,{key:0,"author-id":(u=(i=e.notePreview.author)==null?void 0:i.id)!=null?u:(n=e.authStore.user)==null?void 0:n.id,width:"112px",height:"112px",src:e.previewImage},null,8,["author-id","src"])):(r(),P("div",Ke))]}),_:1})):h("",!0)]),_:1},8,["class"]),a.hideFooter?h("",!0):(r(),m(be,{key:1,class:"q-px-none justify-between q-my-sm actions"},{default:l(()=>[c(e.NoteFooter,{note:e.notePreview,selectable:e.selectable},null,8,["note","selectable"])]),_:1})),a.hideFooter?h("",!0):(r(),m(ge,{key:2}))]}),_:1})):h("",!0)],4)}const ot=A(Oe,[["render",We],["__scopeId","data-v-f9f4e903"],["__file","PublicNotePreview.vue"]]);export{ot as P,Ne as u};
