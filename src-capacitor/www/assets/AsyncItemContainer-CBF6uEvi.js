import{ac as ce,ad as ye,af as ze,d as x,j as _,aY as _e,ai as ue,a_ as qe,r as F,w as Q,bs as Me,bh as Ae,p as fe,bi as de,bj as ve,aa as Se,aZ as Ee,aT as Ve,aI as xe,a$ as Te,b0 as ne,ah as ke,h as Re,bz as Be,z as Fe,o as Oe,A as Ce,a5 as He,E as Le,bP as Pe}from"./index-CzwKTze0.js";const $e=["horizontal","vertical","cell","none"],je=ce({name:"QMarkupTable",props:{...ye,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>$e.includes(e)}},setup(e,{slots:o}){const u=ue(),i=ze(e,u.proxy.$q),v=x(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(i.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>_("div",{class:v.value},[_("table",{class:"q-table"},_e(o.default))])}});function Ne(e,o){return _("div",e,[_("table",{class:"q-table"},o)])}let Y=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const o=document.createElement("div");Object.assign(o.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(o),e.scrollLeft=-1e3,Y=e.scrollLeft>=0,e.remove()}const A=1e3,We=["start","center","end","start-force","center-force","end-force"],me=Array.prototype.filter,Qe=window.getComputedStyle(document.body).overflowAnchor===void 0?qe:function(e,o){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const u=e.children||[];me.call(u,v=>v.dataset&&v.dataset.qVsAnchor!==void 0).forEach(v=>{delete v.dataset.qVsAnchor});const i=u[o];i&&i.dataset&&(i.dataset.qVsAnchor="")}))};function H(e,o){return e+o}function K(e,o,u,i,v,a,g,y){const b=e===window?document.scrollingElement||document.documentElement:e,z=v===!0?"offsetWidth":"offsetHeight",r={scrollStart:0,scrollViewSize:-g-y,scrollMaxSize:0,offsetStart:-g,offsetEnd:-y};if(v===!0?(e===window?(r.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,r.scrollViewSize+=document.documentElement.clientWidth):(r.scrollStart=b.scrollLeft,r.scrollViewSize+=b.clientWidth),r.scrollMaxSize=b.scrollWidth,a===!0&&(r.scrollStart=(Y===!0?r.scrollMaxSize-r.scrollViewSize:0)-r.scrollStart)):(e===window?(r.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,r.scrollViewSize+=document.documentElement.clientHeight):(r.scrollStart=b.scrollTop,r.scrollViewSize+=b.clientHeight),r.scrollMaxSize=b.scrollHeight),u!==null)for(let S=u.previousElementSibling;S!==null;S=S.previousElementSibling)S.classList.contains("q-virtual-scroll--skip")===!1&&(r.offsetStart+=S[z]);if(i!==null)for(let S=i.nextElementSibling;S!==null;S=S.nextElementSibling)S.classList.contains("q-virtual-scroll--skip")===!1&&(r.offsetEnd+=S[z]);if(o!==e){const S=b.getBoundingClientRect(),p=o.getBoundingClientRect();v===!0?(r.offsetStart+=p.left-S.left,r.offsetEnd-=p.width):(r.offsetStart+=p.top-S.top,r.offsetEnd-=p.height),e!==window&&(r.offsetStart+=r.scrollStart),r.offsetEnd+=r.scrollMaxSize-r.offsetStart}return r}function se(e,o,u,i){o==="end"&&(o=(e===window?document.body:e)[u===!0?"scrollWidth":"scrollHeight"]),e===window?u===!0?(i===!0&&(o=(Y===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-o),window.scrollTo(o,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,o):u===!0?(i===!0&&(o=(Y===!0?e.scrollWidth-e.offsetWidth:0)-o),e.scrollLeft=o):e.scrollTop=o}function L(e,o,u,i){if(u>=i)return 0;const v=o.length,a=Math.floor(u/A),g=Math.floor((i-1)/A)+1;let y=e.slice(a,g).reduce(H,0);return u%A!==0&&(y-=o.slice(a*A,u).reduce(H,0)),i%A!==0&&i!==v&&(y-=o.slice(i,g*A).reduce(H,0)),y}const Ye={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Xe={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...Ye};function De({virtualScrollLength:e,getVirtualScrollTarget:o,getVirtualScrollEl:u,virtualScrollItemSizeComputed:i}){const v=ue(),{props:a,emit:g,proxy:y}=v,{$q:b}=y;let z,r,S,p=[],d;const T=F(0),E=F(0),k=F({}),R=F(null),M=F(null),B=F(null),h=F({from:0,to:0}),I=x(()=>a.tableColspan!==void 0?a.tableColspan:100);i===void 0&&(i=x(()=>a.virtualScrollItemSize));const ee=x(()=>i.value+";"+a.virtualScrollHorizontal),he=x(()=>ee.value+";"+a.virtualScrollSliceRatioBefore+";"+a.virtualScrollSliceRatioAfter);Q(he,()=>{C()}),Q(ee,X);function X(){U(r,!0)}function te(t){U(t===void 0?r:t)}function P(t,l){const n=o();if(n==null||n.nodeType===8)return;const m=K(n,u(),R.value,M.value,a.virtualScrollHorizontal,b.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd);S!==m.scrollViewSize&&C(m.scrollViewSize),$(n,m,Math.min(e.value-1,Math.max(0,parseInt(t,10)||0)),0,We.indexOf(l)!==-1?l:r!==-1&&t>r?"end":"start")}function pe(){const t=o();if(t==null||t.nodeType===8)return;const l=K(t,u(),R.value,M.value,a.virtualScrollHorizontal,b.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd),n=e.value-1,m=l.scrollMaxSize-l.offsetStart-l.offsetEnd-E.value;if(z===l.scrollStart)return;if(l.scrollMaxSize<=0){$(t,l,0,0);return}S!==l.scrollViewSize&&C(l.scrollViewSize),D(h.value.from);const w=Math.floor(l.scrollMaxSize-Math.max(l.scrollViewSize,l.offsetEnd)-Math.min(d[n],l.scrollViewSize/2));if(w>0&&Math.ceil(l.scrollStart)>=w){$(t,l,n,l.scrollMaxSize-l.offsetEnd-p.reduce(H,0));return}let f=0,c=l.scrollStart-l.offsetStart,q=c;if(c<=m&&c+l.scrollViewSize>=T.value)c-=T.value,f=h.value.from,q=c;else for(let s=0;c>=p[s]&&f<n;s++)c-=p[s],f+=A;for(;c>0&&f<n;)c-=d[f],c>-l.scrollViewSize?(f++,q=c):q=d[f]+c;$(t,l,f,q)}function $(t,l,n,m,w){const f=typeof w=="string"&&w.indexOf("-force")!==-1,c=f===!0?w.replace("-force",""):w,q=c!==void 0?c:"start";let s=Math.max(0,n-k.value[q]),V=s+k.value.total;V>e.value&&(V=e.value,s=Math.max(0,V-k.value.total)),z=l.scrollStart;const j=s!==h.value.from||V!==h.value.to;if(j===!1&&c===void 0){oe(n);return}const{activeElement:ie}=document,O=B.value;j===!0&&O!==null&&O!==ie&&O.contains(ie)===!0&&(O.addEventListener("focusout",le),setTimeout(()=>{O!==null&&O.removeEventListener("focusout",le)})),Qe(O,n-s);const be=c!==void 0?d.slice(s,n).reduce(H,0):0;if(j===!0){const N=V>=h.value.from&&s<=h.value.to?h.value.to:V;h.value={from:s,to:N},T.value=L(p,d,0,s),E.value=L(p,d,V,e.value),requestAnimationFrame(()=>{h.value.to!==V&&z===l.scrollStart&&(h.value={from:h.value.from,to:V},E.value=L(p,d,V,e.value))})}requestAnimationFrame(()=>{if(z!==l.scrollStart)return;j===!0&&D(s);const N=d.slice(s,n).reduce(H,0),W=N+l.offsetStart+T.value,ae=W+d[n];let G=W+m;if(c!==void 0){const we=N-be,J=l.scrollStart+we;G=f!==!0&&J<W&&ae<J+l.scrollViewSize?J:c==="end"?ae-l.scrollViewSize:W-(c==="start"?0:Math.round((l.scrollViewSize-d[n])/2))}z=G,se(t,G,a.virtualScrollHorizontal,b.lang.rtl),oe(n)})}function D(t){const l=B.value;if(l){const n=me.call(l.children,s=>s.classList&&s.classList.contains("q-virtual-scroll--skip")===!1),m=n.length,w=a.virtualScrollHorizontal===!0?s=>s.getBoundingClientRect().width:s=>s.offsetHeight;let f=t,c,q;for(let s=0;s<m;){for(c=w(n[s]),s++;s<m&&n[s].classList.contains("q-virtual-scroll--with-prev")===!0;)c+=w(n[s]),s++;q=c-d[f],q!==0&&(d[f]+=q,p[Math.floor(f/A)]+=q),f++}}}function le(){B.value!==null&&B.value!==void 0&&B.value.focus()}function U(t,l){const n=1*i.value;(l===!0||Array.isArray(d)===!1)&&(d=[]);const m=d.length;d.length=e.value;for(let f=e.value-1;f>=m;f--)d[f]=n;const w=Math.floor((e.value-1)/A);p=[];for(let f=0;f<=w;f++){let c=0;const q=Math.min((f+1)*A,e.value);for(let s=f*A;s<q;s++)c+=d[s];p.push(c)}r=-1,z=void 0,T.value=L(p,d,0,h.value.from),E.value=L(p,d,h.value.to,e.value),t>=0?(D(h.value.from),Me(()=>{P(t)})):Z()}function C(t){if(t===void 0&&typeof window<"u"){const c=o();c!=null&&c.nodeType!==8&&(t=K(c,u(),R.value,M.value,a.virtualScrollHorizontal,b.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd).scrollViewSize)}S=t;const l=parseFloat(a.virtualScrollSliceRatioBefore)||0,n=parseFloat(a.virtualScrollSliceRatioAfter)||0,m=1+l+n,w=t===void 0||t<=0?1:Math.ceil(t/i.value),f=Math.max(1,w,Math.ceil((a.virtualScrollSliceSize>0?a.virtualScrollSliceSize:10)/m));k.value={total:Math.ceil(f*m),start:Math.ceil(f*l),center:Math.ceil(f*(.5+l)),end:Math.ceil(f*(1+l)),view:w}}function ge(t,l){const n=a.virtualScrollHorizontal===!0?"width":"height",m={["--q-virtual-scroll-item-"+n]:i.value+"px"};return[t==="tbody"?_(t,{class:"q-virtual-scroll__padding",key:"before",ref:R},[_("tr",[_("td",{style:{[n]:`${T.value}px`,...m},colspan:I.value})])]):_(t,{class:"q-virtual-scroll__padding",key:"before",ref:R,style:{[n]:`${T.value}px`,...m}}),_(t,{class:"q-virtual-scroll__content",key:"content",ref:B,tabindex:-1},l.flat()),t==="tbody"?_(t,{class:"q-virtual-scroll__padding",key:"after",ref:M},[_("tr",[_("td",{style:{[n]:`${E.value}px`,...m},colspan:I.value})])]):_(t,{class:"q-virtual-scroll__padding",key:"after",ref:M,style:{[n]:`${E.value}px`,...m}})]}function oe(t){r!==t&&(a.onVirtualScroll!==void 0&&g("virtualScroll",{index:t,from:h.value.from,to:h.value.to-1,direction:t<r?"decrease":"increase",ref:y}),r=t)}C();const Z=Ae(pe,b.platform.is.ios===!0?120:35);fe(()=>{C()});let re=!1;return de(()=>{re=!0}),ve(()=>{if(re!==!0)return;const t=o();z!==void 0&&t!==void 0&&t!==null&&t.nodeType!==8?se(t,z,a.virtualScrollHorizontal,b.lang.rtl):P(r)}),Se(()=>{Z.cancel()}),Object.assign(y,{scrollTo:P,reset:X,refresh:te}),{virtualScrollSliceRange:h,virtualScrollSliceSizeComputed:k,setVirtualScrollSize:C,onVirtualScrollEvt:Z,localResetVirtualScroll:U,padVirtualScroll:ge,scrollTo:P,reset:X,refresh:te}}const Ue={list:xe,table:je},Ze=["list","table","__qtable"],Ie=ce({name:"QVirtualScroll",props:{...Xe,type:{type:String,default:"list",validator:e=>Ze.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:Ee},setup(e,{slots:o,attrs:u}){let i;const v=F(null),a=x(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:g,localResetVirtualScroll:y,padVirtualScroll:b,onVirtualScrollEvt:z}=De({virtualScrollLength:a,getVirtualScrollTarget:T,getVirtualScrollEl:d}),r=x(()=>{if(a.value===0)return[];const M=(B,h)=>({index:g.value.from+h,item:B});return e.itemsFn===void 0?e.items.slice(g.value.from,g.value.to).map(M):e.itemsFn(g.value.from,g.value.to-g.value.from).map(M)}),S=x(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),p=x(()=>e.scrollTarget!==void 0?{}:{tabindex:0});Q(a,()=>{y()}),Q(()=>e.scrollTarget,()=>{k(),E()});function d(){return v.value.$el||v.value}function T(){return i}function E(){i=Te(d(),e.scrollTarget),i.addEventListener("scroll",z,ne.passive)}function k(){i!==void 0&&(i.removeEventListener("scroll",z,ne.passive),i=void 0)}function R(){let M=b(e.type==="list"?"div":"tbody",r.value.map(o.default));return o.before!==void 0&&(M=o.before().concat(M)),ke(o.after,M)}return fe(()=>{y()}),Ve(()=>{E()}),ve(()=>{E()}),de(()=>{k()}),Se(()=>{k()}),()=>{if(o.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?Ne({ref:v,class:"q-table__middle "+S.value},R()):_(Ue[e.type],{...u,ref:v,class:[u.class,S.value],...p.value},R)}}}),Ge=Re({__name:"AsyncItemContainer",props:{index:{},itemsList:{},height:{}},setup(e,{expose:o}){o();const u=e,i=Be(u,"itemsList"),v=x(()=>{const{index:g}=u;return i.value[g]}),a={props:u,itemsList:i,item:v};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}});function Je(e,o,u,i,v,a){return Oe(),Ce("div",{style:Pe({height:u.height+"px"})},[i.item?He(e.$slots,"default",{key:0,item:i.item,index:u.index}):Le("",!0)],4)}const et=Fe(Ge,[["render",Je],["__file","AsyncItemContainer.vue"]]);export{et as A,Ie as Q,Y as r};
