import{ad as R,ae as j,ag as L,r as h,d as v,w as p,j as z,aZ as k,bu as F,ai as O,aj as $,bt as H,h as B,aw as M,bS as Q,z as A,o as x,A as I,k as U,at as J,ak as Z,m as G,q as K,J as W,R as X,ab as Y,ay as ee,e as D,N as q,aN as te,F as V,E as re,bx as ae,B as w,D as oe}from"./index-BVsaSLwH.js";import{T as se,u as ne}from"./TouchPan-D-QkRPeS.js";import{Q as ie}from"./QPage-CJ6xh3ay.js";import{r as le}from"./min-page-height-rAf57wJ4.js";import{u as ue}from"./note-detail-commands-Bq-HL6Uf.js";import{E as de}from"./EncryptionRequred-CJlua3ii.js";const ce=R({name:"QSplitter",props:{...j,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:l,emit:r}){const{proxy:{$q:t}}=$(),i=L(e,t),n=h(null),a={before:h(null),after:h(null)},c=v(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(i.value===!0?" q-splitter--dark":"")),_=v(()=>e.horizontal===!0?"height":"width"),d=v(()=>e.reverse!==!0?"before":"after"),o=v(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function m(s){return(e.unit==="%"?s:Math.round(s))+e.unit}const f=v(()=>({[d.value]:{[_.value]:m(e.modelValue)}}));let y,g,S,N,u;function E(s){if(s.isFirst===!0){const T=n.value.getBoundingClientRect()[_.value];y=e.horizontal===!0?"up":"left",g=e.unit==="%"?100:T,S=Math.min(g,o.value[1],Math.max(o.value[0],e.modelValue)),N=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:t.lang.rtl===!0?-1:1)*(e.unit==="%"?T===0?0:100/T:1),n.value.classList.add("q-splitter--active");return}if(s.isFinal===!0){u!==e.modelValue&&r("update:modelValue",u),n.value.classList.remove("q-splitter--active");return}const b=S+N*(s.direction===y?-1:1)*s.distance[e.horizontal===!0?"y":"x"];u=Math.min(g,o.value[1],Math.max(o.value[0],b)),a[d.value].value.style[_.value]=m(u),e.emitImmediately===!0&&e.modelValue!==u&&r("update:modelValue",u)}const C=v(()=>[[se,E,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function P(s,b){s<b[0]?r("update:modelValue",b[0]):s>b[1]&&r("update:modelValue",b[1])}return p(()=>e.modelValue,s=>{P(s,o.value)}),p(()=>e.limits,()=>{H(()=>{P(e.modelValue,o.value)})}),()=>{const s=[z("div",{ref:a.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:f.value.before},k(l.before)),z("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[F("div",{class:"q-splitter__separator-area absolute-full"},k(l.separator),"sep",e.disable!==!0,()=>C.value)]),z("div",{ref:a.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:f.value.after},k(l.after))];return z("div",{class:c.value,ref:n},O(l.default,s))}}}),me=B({__name:"NoteDebugger",props:{cursorPosition:{}},setup(e,{expose:l}){l();const r=e,t=M(),i=h(null),n=h(),a=d=>{let o;const m=r.cursorPosition;return Q(d,f=>(f.start<=m&&f.end>=m&&(o=f),!1)),o},c=()=>{i.value=a(t.orgTree);const[d,o]=[i.value?.start,i.value?.end];n.value=t.orgTree?.toString().replace(`[${d}-${o}]`,`<span style="background-color: var(--yellow); color: var(--base2)">[${d}-${o}]</span>`)};c(),p(()=>[t.orgTree,r.cursorPosition],()=>{c()});const _={props:r,noteEditorStore:t,selectedNode:i,parsedNoteTextTree:n,findSelectedNode:a,initDebugTree:c};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),fe=["innerHTML"];function _e(e,l,r,t,i,n){return x(),I("div",{class:"org-debug",innerHTML:t.parsedNoteTextTree},null,8,fe)}const ve=A(me,[["render",_e],["__scopeId","data-v-5fcace4b"],["__file","NoteDebugger.vue"]]),ge=B({__name:"NoteEditorPage",setup(e,{expose:l}){l();const r=U(),t=r.params.id,i=M(),n=J();n.resetNote(),n.selectNoteById(t);const{currentNote:a,currentOrgTree:c}=Z(n),_=h(50),d=()=>{a.value&&(i.setFilePath(a.value.filePath),i.setNoteTree(c.value),i.setCreatedTime(a.value.createdAt))};d(),p(()=>a.value,()=>d()),p(()=>r.params.id,u=>u&&n.selectNoteById(u));const o=v(()=>!r.params.id||a.value?.id===r.params.id),m=G(),f=()=>{(o.value?m.loading.hide:m.loading.show)()};f(),p(()=>o.value,()=>f()),ne(),ue();const y=K(),g=W(),S=g.$onAction(({name:u,args:E})=>{const C=E?.[0];u!=="deleteNotes"||!C||!C.find(s=>s===i.note.id)||y.push({name:X.Home})});Y(()=>{m.loading.hide(),S()});const N={route:r,noteId:t,noteEditorStore:i,currentNoteStore:n,currentNote:a,currentOrgTree:c,splitterSize:_,setupEditorStore:d,noteLoaded:o,$q:m,initLoaderStatus:f,router:y,notesStore:g,unsubscribeFileManager:S,get resetPageMinHeight(){return le},NoteDebugger:ve,EncryptionRequired:de};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),be={key:0,class:"q-pa-md"},he={class:"debug q-pa-md"},pe={class:"common-info q-px-md"},ye={class:"debug-tree q-py-sm q-px-md"};function Se(e,l,r,t,i,n){const a=ee("router-view");return x(),D(ie,{class:te({flex:t.noteEditorStore.debug,"debug-page":t.noteEditorStore.debug}),"style-fn":t.resetPageMinHeight},{default:q(()=>[V(t.EncryptionRequired,{note:t.currentNote},{default:q(()=>[t.noteEditorStore.debug?(x(),D(ce,{key:0,modelValue:t.splitterSize,"onUpdate:modelValue":l[0]||(l[0]=c=>t.splitterSize=c),horizontal:t.$q.screen.lt.sm,class:"debug-splitter"},{before:q(()=>[t.noteLoaded?(x(),I("div",be,[V(a)])):re("",!0)]),separator:q(()=>[V(ae,{color:"primary","text-color":"white",size:"40px",icon:"drag_indicator"})]),after:q(()=>[w("div",he,[w("div",pe," Cursor: "+oe(t.noteEditorStore.cursorPosition),1),w("div",ye,[V(t.NoteDebugger,{"cursor-position":t.noteEditorStore.cursorPosition},null,8,["cursor-position"])])])]),_:1},8,["modelValue","horizontal"])):(x(),D(a,{key:1}))]),_:1},8,["note"])]),_:1},8,["class","style-fn"])}const Ee=A(ge,[["render",Se],["__scopeId","data-v-7e30b7e9"],["__file","NoteEditorPage.vue"]]);export{Ee as default};
