import{a as F,Q as M,u as G}from"./view-C-iT-fi2.js";import{m as W,r as T,w as j,cQ as X,bS as L,d as _,h as B,bz as A,aw as O,q as H,R as Q,z as E,o as l,A as k,a5 as Z,B as g,e as d,cO as J,E as h,F as i,H as S,L as n,cV as V,aI as K,bk as C,aE as z,aF as I,C as x,D as p,bI as q,ac as Y,cW as $,cX as ee,j as N,$ as D,ah as te,cY as oe,cZ as ae,c_ as se,aY as ne,G as le,P as ie,bE as re,t as ce,s as de,l as ue,cS as me,c$ as fe,by as ve,aM as R,a8 as he,d0 as _e,bP as pe}from"./index-CzwKTze0.js";import{A as ge}from"./AuthorInfo-DKdoTIw-.js";function be(t){return t.replace(/\.[^/.]+$/,"")}const ye=()=>{const t=W(),o=T("sm"),a=()=>o.value=t.screen.gt.sm?"xs":"sm";return j(()=>t.screen.gt.sm,a),a(),{iconSize:o}},we=X("selected-notes",()=>{const t=T(new Set),o=L(),a=_(()=>t.value.size===o.notes.length),e=()=>{if(a.value){t.value.clear();return}t.value=new Set(o.notes.map(u=>u.id))},r=u=>{if(t.value.has(u)){t.value.delete(u);return}t.value.add(u)},m=u=>t.value.has(u),s=_(()=>o.notes.length===t.value.size),f=_(()=>t.value.size>0),c=()=>t.value.clear();return{toggleBulkNotesSelection:e,allNotesSelected:a,toggleNoteSelection:r,isNoteSelected:m,isAllNotesSelected:s,isSomeNotesSelected:f,selectedNotesIds:_(()=>[...t.value]),clearSelectedNotes:c}}),Se=B({__name:"NoteFooter",props:{selectable:{type:Boolean},note:{}},setup(t,{expose:o}){o();const a=t,e=A(a,"selectable"),r=A(a,"note"),m=we(),s=O(),f=b=>{s.notify(`Feature ${b} is not implemented yet!`)},c=L(),u=H(),P=async()=>{await c.markAsDeleted([r.value.id]),u.push({name:Q.Home})},v=()=>{u.push({name:Q.EditNote,params:{id:r.value.id}})},{iconSize:y}=ye(),w={props:a,selectable:e,note:r,selectedNotesStore:m,notifications:s,showNotImplemented:f,notesStore:c,router:u,deleteNote:P,editNote:v,iconSize:y};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),ke={class:"footer column q-py-bp-lg full-width"},Ne={class:"note-actions full-width row justify-between"},Pe={class:"left"},xe={class:"right row gap-sm action-btns"};function Ce(t,o,a,e,r,m){return l(),k("div",ke,[Z(t.$slots,"default",{},void 0,!0),g("div",Ne,[g("div",Pe,[e.selectable?(l(),d(J,{key:0,size:e.iconSize,"model-value":e.selectedNotesStore.isNoteSelected(e.note.id),"onUpdate:modelValue":o[0]||(o[0]=s=>e.selectedNotesStore.toggleNoteSelection(e.note.id))},null,8,["size","model-value"])):h("",!0)]),g("div",xe,[i(S,{onClick:o[1]||(o[1]=s=>e.notesStore.toggleBookmark(e.note)),size:e.iconSize,flat:"",round:"",icon:e.note.bookmarked?"o_bookmark":"o_bookmark_added",class:"q-pa-none"},null,8,["size","icon"]),i(S,{size:e.iconSize,flat:"",round:"",icon:"far fa-paper-plane",class:"q-pa-none"},{default:n(()=>[i(V,{class:"flex row no-wrap"},{default:n(()=>[i(S,{flat:"",rounded:"",size:"md",icon:"fa-brands fa-square-twitter",class:"q-pa-sm",onClick:o[2]||(o[2]=s=>e.showNotImplemented("Twitter share"))}),i(S,{flat:"",rounded:"",size:"md",icon:"fa-brands fa-telegram",class:"q-pa-sm",onClick:o[3]||(o[3]=s=>e.showNotImplemented("Telegram share"))}),i(S,{flat:"",rounded:"",size:"md",icon:"far fa-copy",class:"q-pa-sm",onClick:o[4]||(o[4]=s=>e.showNotImplemented("Copy link"))})]),_:1})]),_:1},8,["size"]),i(S,{size:e.iconSize,flat:"",round:"",icon:"fas fa-ellipsis",class:"q-pa-none"},{default:n(()=>[i(V,null,{default:n(()=>[i(K,{style:{"min-width":"100px"}},{default:n(()=>[e.note.isMy?C((l(),d(z,{key:0,clickable:"",onClick:e.deleteNote},{default:n(()=>[i(I,{class:"text-capitalize"},{default:n(()=>[x(p(t.$t("delete")),1)]),_:1})]),_:1})),[[q]]):h("",!0),e.note.isMy?C((l(),d(z,{key:1,clickable:"",onClick:e.editNote},{default:n(()=>[i(I,{class:"text-capitalize"},{default:n(()=>[x(p(t.$t("edit")),1)]),_:1})]),_:1})),[[q]]):h("",!0),e.note.isMy?h("",!0):C((l(),d(z,{key:2,clickable:"",onClick:o[5]||(o[5]=s=>e.showNotImplemented(t.$t("report")))},{default:n(()=>[i(I,{class:"text-capitalize"},{default:n(()=>[x(p(t.$t("report")),1)]),_:1})]),_:1})),[[q]]),e.note.isMy?h("",!0):C((l(),d(z,{key:3,clickable:"",onClick:o[6]||(o[6]=s=>e.showNotImplemented(t.$t("save")))},{default:n(()=>[i(I,{class:"text-capitalize"},{default:n(()=>[x(p(t.$t("save")),1)]),_:1})]),_:1})),[[q]])]),_:1})]),_:1})]),_:1},8,["size"])])])])}const ze=E(Se,[["render",Ce],["__scopeId","data-v-41016de0"],["__file","NoteFooter.vue"]]),Ie=Y({name:"QBreadcrumbsEl",props:{...$,label:String,icon:String,tag:{type:String,default:"span"}},emits:["click"],setup(t,{slots:o}){const{linkTag:a,linkAttrs:e,linkClass:r,navigateOnClick:m}=ee(),s=_(()=>({class:"q-breadcrumbs__el q-link flex inline items-center relative-position "+(t.disable!==!0?"q-link--focusable"+r.value:"q-breadcrumbs__el--disable"),...e.value,onClick:m})),f=_(()=>"q-breadcrumbs__el-icon"+(t.label!==void 0?" q-breadcrumbs__el-icon--with-label":""));return()=>{const c=[];return t.icon!==void 0&&c.push(N(D,{class:f.value,name:t.icon})),t.label!==void 0&&c.push(t.label),N(a.value,{...s.value},te(o.default,c))}}}),qe=["",!0],Fe=Y({name:"QBreadcrumbs",props:{...oe,separator:{type:String,default:"/"},separatorColor:String,activeColor:{type:String,default:"primary"},gutter:{type:String,validator:t=>["none","xs","sm","md","lg","xl"].includes(t),default:"sm"}},setup(t,{slots:o}){const a=ae(t),e=_(()=>`flex items-center ${a.value}${t.gutter==="none"?"":` q-gutter-${t.gutter}`}`),r=_(()=>t.separatorColor?` text-${t.separatorColor}`:""),m=_(()=>` text-${t.activeColor}`);return()=>{if(o.default===void 0)return;const s=se(ne(o.default));if(s.length===0)return;let f=1;const c=[],u=s.filter(v=>v.type!==void 0&&v.type.name==="QBreadcrumbsEl").length,P=o.separator!==void 0?o.separator:()=>t.separator;return s.forEach(v=>{if(v.type!==void 0&&v.type.name==="QBreadcrumbsEl"){const y=f<u,w=v.props!==null&&qe.includes(v.props.disable),b=(y===!0?"":" q-breadcrumbs--last")+(w!==!0&&y===!0?m.value:"");f++,c.push(N("div",{class:`flex items-center${b}`},[v])),y===!0&&c.push(N("div",{class:"q-breadcrumbs__separator"+r.value},P()))}else c.push(v)}),N("div",{class:"q-breadcrumbs"},[N("div",{class:e.value},c)])}}}),Qe=B({__name:"FilePath",props:{filePath:{}},setup(t,{expose:o}){o();const a=t,e=A(a,"filePath"),r=O(),s={props:a,filePath:e,notifications:r,searchInFolder:f=>r.notify(`This functionality is not implemented yet. You clicked on ${f}`),get removeFileExtension(){return be}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}});function Be(t,o,a,e,r,m){return l(),d(Fe,{class:"text-italic color-secondary pointer flex breadcrumbs"},{separator:n(()=>[i(D,{size:"1.5em",name:"chevron_right",class:"color-secondary"})]),default:n(()=>[(l(!0),k(le,null,ie(e.filePath,(s,f)=>(l(),d(Ie,{class:"color-secondary text-no-wrap",label:f===e.filePath.length-1?e.removeFileExtension(s):s,key:s,onClick:re(c=>e.searchInFolder(s),["stop","prevent"])},null,8,["label","onClick"]))),128))]),_:1})}const Ee=E(Qe,[["render",Be],["__file","FilePath.vue"]]),Ae=B({__name:"EncryptedNoteCard",props:{noteName:{}},setup(t,{expose:o}){o();const a={};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),Te={class:"full-width lock-description"},De={class:"text-center"},Ve={class:"text-center q-mt-md"};function Re(t,o,a,e,r,m){return l(),d(M,{class:"full-height color-main cursor-pointer"},{default:n(()=>[i(F,{class:"full-height flex center items-center"},{default:n(()=>[g("div",Te,[i(D,{class:"shield-icon color-main",name:"sym_o_encrypted",size:"12rem"}),g("h4",De,p(a.noteName)+" "+p(t.$t("is encrypted")),1),g("h5",Ve,p(t.$t("please, configure encryption settings for decrypt note")),1)])]),_:1})]),_:1})}const Me=E(Ae,[["render",Re],["__file","EncryptedNoteCard.vue"]]),je=B({__name:"PublicNotePreview",props:{notePreview:{},showAuthor:{type:Boolean},selectable:{type:Boolean},height:{},hideFooter:{type:Boolean},fullHeight:{type:Boolean}},setup(t,{expose:o}){o();const a=t,{notePreview:e,selectable:r}=ce(a),m=_(()=>`${a.height}px`),s=H(),f=b=>{const U=b.isMy?Q.RawEditor:Q.NoteDetail;s.push({name:U,params:{id:b.id}})},c=G(),u=_(()=>c.tile),P=de(),v=T(e.value?.meta.images?.[0]);j(()=>e.value?.meta.images,b=>{v.value=b?.[0]});const y=ue(),w={props:a,notePreview:e,selectable:r,height:m,router:s,openNoteDetail:f,viewStore:c,isTile:u,settingsStore:P,previewImage:v,authStore:y,NoteFooter:ze,TagList:me,AuthorInfo:ge,FilePath:Ee,ImageResolver:fe,EncryptedNoteCard:Me,get extractDynamicValue(){return ve}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),Le={key:0,class:"q-px-sm"},Oe={class:"full-width"},He={class:"text-overline"},Ye={class:"text-h4 text-weight-bold pointer"},Ue={class:"text-caption rft description"},Ge={key:0,class:"italic color-secondary"},We={key:1,class:"mock-picture pointer rounded-borders"};function Xe(t,o,a,e,r,m){return l(),k("article",{style:pe({height:e.height})},[e.notePreview.encrypted?(l(),d(e.EncryptedNoteCard,{key:0,noteName:e.notePreview.filePath.slice(-1)[0],onClick:o[0]||(o[0]=s=>e.openNoteDetail(e.notePreview))},null,8,["noteName"])):e.notePreview?(l(),d(M,{key:1,class:"full-height color-main",flat:""},{default:n(()=>[e.notePreview?.author&&e.settingsStore.config.ui.showUserProfiles&&a.showAuthor?(l(),k("div",Le,[i(e.AuthorInfo,{author:e.notePreview.author},null,8,["author"])])):h("",!0),i(F,{horizontal:"",class:R([{"note-card-content":e.isTile||!a.fullHeight,column:e.isTile,"full-height":a.fullHeight},"pointer q-px-sm"]),onClick:o[1]||(o[1]=s=>e.openNoteDetail(e.notePreview))},{default:n(()=>[e.isTile&&e.previewImage?(l(),d(e.ImageResolver,{key:0,src:e.previewImage},null,8,["src"])):h("",!0),i(F,{class:R(["fit q-pa-none q-pt-sm note-text-content",{"content-with-img":!!e.previewImage}])},{default:n(()=>[g("div",Oe,[g("div",He,p(e.notePreview.meta.category),1),g("div",Ye,p(e.extractDynamicValue(e.notePreview.meta.title)||e.notePreview.filePath.slice(-1)[0]),1),e.notePreview.filePath?(l(),d(e.FilePath,{key:0,"file-path":e.notePreview.filePath,class:"q-py-xs"},null,8,["file-path"])):h("",!0),g("div",Ue,[e.settingsStore.config.developer.developerMode?(l(),k("span",Ge," ["+p(new Date(e.notePreview.updatedAt).toLocaleString())+"] ",1)):h("",!0),x(" "+p(e.notePreview.meta.description),1)])]),i(e.TagList,{tags:e.notePreview?.meta?.fileTags,inline:!0},null,8,["tags"])]),_:1},8,["class"]),!e.isTile&&e.previewImage?(l(),d(F,{key:1,class:"flex col-3 flex-start q-pa-none q-pt-sm justify-end img-preview-section"},{default:n(()=>[e.previewImage?(l(),d(e.ImageResolver,{key:0,"author-id":e.notePreview.author?.id??e.authStore.user?.id,width:"112px",height:"112px",src:e.previewImage},null,8,["author-id","src"])):(l(),k("div",We))]),_:1})):h("",!0)]),_:1},8,["class"]),a.hideFooter?h("",!0):(l(),d(he,{key:1,class:"q-px-none justify-between q-my-sm actions"},{default:n(()=>[i(e.NoteFooter,{note:e.notePreview,selectable:e.selectable},null,8,["note","selectable"])]),_:1})),a.hideFooter?h("",!0):(l(),d(_e,{key:2}))]),_:1})):h("",!0)],4)}const $e=E(je,[["render",Xe],["__scopeId","data-v-8df0c52a"],["__file","PublicNotePreview.vue"]]);export{$e as P,we as u};
