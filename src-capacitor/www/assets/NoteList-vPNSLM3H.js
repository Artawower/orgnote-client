import{Q as C,A as R}from"./AsyncItemContainer-CBF6uEvi.js";import{u as T}from"./view-C-iT-fi2.js";import{h as F,bz as n,d as I,q as L,r as _,k as Q,bF as q,w as x,aT as j,z as E,o as z,A as M,e as O,L as P,F as k,B as D,aM as p,E as W}from"./index-CzwKTze0.js";import{P as G}from"./PublicNotePreview-Iam3jDMG.js";const H=F({__name:"NoteList",props:{selectable:{type:Boolean},limit:{},offset:{},total:{},notes:{},fetchNotes:{},scrollTarget:{},height:{default:230}},setup(b,{expose:w}){w();const t=b,e=n(t,"selectable"),g=n(t,"limit"),s=n(t,"total"),u=n(t,"notes"),o=T(),f=I(()=>o.tile),N=L(),a=_(null),S=Q(),V=q(t.fetchNotes,300),d=_(0);x(()=>d.value,l=>N.replace({query:{from:l}}));const m=+S.query.from||0,A=(l,c)=>{const v=Object.freeze(new Array(c).fill(null));return V(l,c),v};let i=!1;const h=()=>{i||!m||!s.value||!a.value||(setTimeout(()=>{a.value.scrollTo(m,"start")}),i=!0)},B=l=>{d.value=l.index};x([s,a],()=>h()),j(()=>{h()});const r=_([]),y={props:t,selectable:e,limit:g,total:s,notes:u,viewStore:o,tileView:f,router:N,virtualScrollRef:a,route:S,fetchNotesWithDebounce:V,lastFrom:d,initialFrom:m,getPagedNotes:A,get alreadyScrolled(){return i},set alreadyScrolled(l){i=l},scrollAfterInit:h,onVirtualScroll:B,selectedNotes:r,selectNote:(l,c)=>{if(e.value){if(c){r.value=[...r.value,l];return}r.value=r.value.filter(v=>v.id!==l.id)}},get QVirtualScroll(){return C},AsyncItemContainer:R,PublicNotePreview:G};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}});function J(b,w,t,e,g,s){return z(),M("div",{class:p(["items-start public-notes",{row:e.tileView,column:!e.tileView}])},[t.scrollTarget?(z(),O(e.QVirtualScroll,{key:0,ref:"virtualScrollRef",onVirtualScroll:e.onVirtualScroll,"items-size":e.total,"virtual-scroll-slice-size":e.limit||10,"virtual-scroll-item-size":230,"items-fn":e.getPagedNotes,"scroll-target":t.scrollTarget,class:"full-width",style:{"max-height":"cacl(100svh - 66px)"}},{default:P(({index:u})=>[k(e.AsyncItemContainer,{"items-list":e.notes,index:u,height:t.height},{default:P(({item:o})=>[D("div",{class:p({fit:!e.tileView,"col-4":e.tileView})},[k(e.PublicNotePreview,{"note-preview":o,"show-author":!e.selectable,selectable:e.selectable,height:t.height,onSelected:f=>e.selectNote(o,f)},null,8,["note-preview","show-author","selectable","height","onSelected"])],2)]),_:2},1032,["items-list","index","height"])]),_:1},8,["items-size","virtual-scroll-slice-size","scroll-target"])):W("",!0)],2)}const $=E(H,[["render",J],["__scopeId","data-v-b85babf7"],["__file","NoteList.vue"]]);export{$ as N};
